# AutoGen GraphFlow 智能体团队示例

## 📚 项目简介

本项目展示了Microsoft AutoGen v0.5.6中新增的GraphFlow功能，这是一种强大的智能体团队协作框架，允许通过有向图来精确控制多个智能体之间的工作流程。项目包含三个主要示例，分别演示了不同类型的工作流模式：

1. **顺序工作流** (sequential-flow.py)：展示智能体按顺序依次工作的模式
2. **并行工作流** (parallel-flow.py)：展示智能体并行工作并合并结果的模式
3. **旅行规划团队** (travel-agent.py)：展示复杂的混合工作流，结合顺序和并行处理

## 🔍 GraphFlow 核心概念

GraphFlow是AutoGen v0.5.6引入的实验性功能，它提供了以下关键能力：

- **精确控制执行顺序**：通过有向图定义智能体间的工作流
- **支持并行执行**：多个智能体可以同时处理任务
- **消息过滤机制**：控制每个智能体能看到的上下文信息
- **灵活的工作流设计**：支持顺序执行、并行分支、合并节点等模式

## 🛠️ 核心组件

### DiGraphBuilder

用于构建有向图的流畅API，主要方法包括：

- `add_node(agent)`: 添加智能体节点
- `add_edge(from_agent, to_agent)`: 添加从一个智能体到另一个智能体的边
- `build()`: 构建并验证图
- `get_participants()`: 获取所有参与者

### GraphFlow

基于有向图执行工作流的团队类，主要方法包括：

- `run(task)`: 同步执行工作流
- `run_stream(task)`: 异步执行工作流并返回可迭代的事件流

### MessageFilterAgent

用于过滤消息的代理包装器，可以控制智能体能看到的消息范围：

- `per_source`: 按消息来源过滤
- `position`: 控制保留第一条、最后一条或所有消息
- `count`: 控制保留消息的数量

## 🌟 示例说明

### 1. 顺序工作流 (sequential-flow.py)

这个示例展示了一个简单的翻译工作流，包含三个按顺序工作的智能体：

1. **翻译器** (translator)：将英文文本翻译为中文
2. **校对者** (proofreader)：检查翻译质量并提出修改建议
3. **格式化器** (formatter)：调整最终输出的格式

特点：
- 使用不同的模型后端(OpenAI、Gemini、Ollama)
- 简单的线性工作流
- 展示基本的GraphFlow构建和执行过程

### 2. 并行工作流 (parallel-flow.py)

这个示例展示了一个包含并行处理和合并节点的工作流：

1. **写作者** (writer)：起草初始文案
2. **语法编辑** (editor_grammar)：并行处理，专注于语法修正
3. **风格编辑** (editor_style)：并行处理，专注于风格优化
4. **终审编辑** (final_reviewer)：合并两个编辑的结果

特点：
- 展示"扇出"(fan-out)和"扇入"(fan-in)模式
- 并行处理提高效率
- 结果合并处理

### 3. 旅行规划团队 (travel-agent.py)

这个示例展示了一个更复杂的混合工作流，用于旅行规划：

1. **规划师** (planner_agent)：制定基础旅行框架
2. **当地专家** (local_agent)：并行处理，提供当地活动和景点建议
3. **语言专家** (language_agent)：并行处理，提供语言和沟通技巧
4. **总结智能体** (travel_summary_agent)：整合所有建议生成最终计划

特点：
- 使用MessageFilterAgent控制每个智能体能看到的消息
- 混合顺序和并行处理
- 更复杂的工作流设计
- 专业化智能体分工

## 🚀 如何运行

确保已安装所需依赖：

```bash
pip install -U autogen-agentchat autogen-ext
```

运行示例：

```bash
# 运行顺序工作流示例
python sequential-flow.py

# 运行并行工作流示例
python parallel-flow.py

# 运行旅行规划团队示例
python travel-agent.py
```

## 📈 GraphFlow的优势

- **结构化工作流**：相比传统的群聊模式，GraphFlow提供更精确的控制
- **上下文管理**：通过消息过滤减少不必要的上下文干扰
- **专业化分工**：每个智能体专注于特定任务，提高整体效率
- **灵活的执行模式**：支持各种工作流模式，适应不同场景需求

## 🔮 应用场景

GraphFlow团队适用于多种复杂任务场景：

1. **内容创作与编辑**：多阶段审核和优化
2. **多语言翻译与本地化**：翻译、校对、文化适应
3. **旅行规划**：综合考虑多方面专业建议
4. **产品设计**：从概念到实现的多阶段流程
5. **研究分析**：数据收集、分析和报告生成
6. **教育内容开发**：课程设计、内容创建和评审

## 📝 注意事项

- GraphFlow是AutoGen v0.5.6的实验性功能，API可能会有变化
- 复杂工作流设计需要仔细考虑智能体间的依赖关系
- 消息过滤配置对性能和结果质量有重要影响
- 确保每个智能体的系统提示明确定义其职责和输出格式
